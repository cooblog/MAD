<!doctype html><html lang="en"><head><meta charSet="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><title>Veera's Internship, Week 9: Arranging Furniture | Engineering at MAD – Digital Product Studio</title><meta name="description" content="This week, I spent time planning a function that could be used to position objects in the room. For example, I might want to place two cubes around a plant, but they should never overlap with the plant or each other. " /><meta property="og:url" content="https://www.mad.ac/" /><meta property="og:title" content="Veera's Internship, Week 9: Arranging Furniture | Engineering at MAD – Digital Product Studio" /><meta property="og:description" content="This week, I spent time planning a function that could be used to position objects in the room. For example, I might want to place two cubes around a plant, but they should never overlap with the plant or each other. " /><meta property="og:image" content="https://mad.ac/images/social/mad-engineering-og-light.png" /><meta property="og:type" content="website" /><meta name="twitter:card" content="summary_large_image" /><meta name="twitter:site" content="@createdbymad" /><meta name="twitter:creator" content="@createdbymad" /><link rel="icon" href="../../favicon.ico" /><link rel="icon" href="../../favicon.svg" type="image/svg+xml" /><link rel="apple-touch-icon" href="../../apple-touch-icon.png" /><link rel="manifest" href="../../manifest.json" /><link rel="alternate" href="../feed.xml" type="application/rss+xml" title="MAD Engineering Blog Feed (RSS)" /><link rel="alternate" href="../feed.json" type="application/json" title="MAD Engineering Blog Feed (JSON)" /><link rel="preload" href="../../fonts/GT-MaruBeta-Bold.woff2" as="font" type="font/woff2" crossOrigin="true" /><link rel="preload" href="../../fonts/GT-MaruBeta-Regular.woff2" as="font" type="font/woff2" crossOrigin="true" /><link rel="stylesheet" href="../../styles/main%EF%B9%96v=431300964a77750d3c621bffa45c154cb1e8582c.css" /><script src="https://cdn.usefathom.com/script.js" data-site="ZUYODAUJ" defer></script></head><body class="blog font-serif"><header class="blog-header"><p class="blog-intro">Welcome to <a href="../../engineering.html">Engineering at MAD</a>. A space for creative tech, with words directly from our engineers.</p><nav class="blog-nav"><div class="blog-nav-home"><a href="../../index.html">mad.ac</a></div><div class="blog-nav-feeds"><a href="../feed.xml">Atom</a><a href="../feed.json">JSON</a></div></nav></header><main class="blog-content"><article class="post copy flow"><h1 class="post-title">Veera's Internship, Week 9: Arranging Furniture</h1><p class="post-byline"><span class="post-date">07/06/2021</span><span class="post-author">By <a href="../../team/veera.html">Veera Jussila</a></span></p><div class="post-content copy flow"><ul>
<li><a href="veera-intern-blog-week-1.html">Week 1: Intern&#39;s Greetings!</a></li>
<li><a href="veera-intern-blog-week-2.html">Week 2: Refining the MVP</a></li>
<li><a href="veera-intern-blog-week-3.html">Week 3: Diving Into Shaders</a></li>
<li><a href="veera-intern-blog-week-4.html">Week 4: From 2D to 3D</a></li>
<li><a href="veera-intern-blog-week-5.html">Week 5: Back to Inspiration Images</a></li>
<li><a href="veera-intern-blog-week-6.html">Week 6: Blended Approach</a></li>
<li><a href="veera-intern-blog-week-7.html">Week 7: Restructuring the Project</a></li>
<li><a href="veera-intern-blog-week-8.html">Week 8: Drawing Board</a></li>
</ul>
<p>This week, I spent time planning a function that could be used to position objects in the room. For example, I might want to place two cubes around a plant, but they should never overlap with the plant or each other. When trying to understand this problem, I found this <a href="https://www.youtube.com/watch?v=XATr_jdh-44">video</a> by <strong>Daniel Shiffman</strong> very useful. That combined with pseudocode that <a href="../../team/nikolai.html">Nikolai</a> provided was the key to create some functions.</p>
<p>The pseudocode:</p>
<pre><code class="language-javascript"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> max<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  outer<span class="token operator">:</span> <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> point <span class="token operator">=</span> <span class="token function">make_random_point</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> i<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">dist</span><span class="token punctuation">(</span>locations<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> point<span class="token punctuation">)</span> <span class="token operator">&lt;</span> limit<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">continue</span> outer<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    locations<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>point<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>We wanted to create arrays for the possible locations of objects, either around a circle or semicircle. There is a central object with some orbiting objects:</p>
<pre><code class="language-javascript"><span class="token keyword">const</span> locationsCircle <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> locationsHalfCircle <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">neighbour_location_circle</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> cx<span class="token punctuation">,</span> cy<span class="token punctuation">,</span> cz<span class="token punctuation">,</span> min<span class="token punctuation">,</span> max<span class="token punctuation">,</span> startAngle <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> endAngle <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// distance from the object in the center</span>
  <span class="token keyword">const</span> distance <span class="token operator">=</span> min <span class="token operator">+</span> <span class="token punctuation">(</span>max <span class="token operator">-</span> min<span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> angle <span class="token operator">=</span> startAngle <span class="token operator">+</span> <span class="token punctuation">(</span>endAngle <span class="token operator">-</span> startAngle<span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span>cx <span class="token operator">+</span> distance <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>angle<span class="token punctuation">)</span><span class="token punctuation">,</span> cy<span class="token punctuation">,</span> cz <span class="token operator">+</span> distance <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>angle<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// how close to each other the orbiting objects can be</span>
<span class="token keyword">let</span> limit <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>
<span class="token comment">// number of positions to create</span>
<span class="token keyword">let</span> numOfLoc <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">dist</span><span class="token punctuation">(</span><span class="token parameter">x1<span class="token punctuation">,</span> x2<span class="token punctuation">,</span> y1<span class="token punctuation">,</span> y2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> a <span class="token operator">=</span> x1 <span class="token operator">-</span> x2<span class="token punctuation">;</span>
  <span class="token keyword">var</span> b <span class="token operator">=</span> y1 <span class="token operator">-</span> y2<span class="token punctuation">;</span>
  <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span>a <span class="token operator">*</span> a <span class="token operator">+</span> b <span class="token operator">*</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Creating positions for orbiting objects by using <code>limit</code> and checking that they don&#39;t overlap:</p>
<pre><code class="language-javascript"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> numOfLoc<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  outer<span class="token operator">:</span> <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> point <span class="token operator">=</span> <span class="token function">neighbour_location_circle</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      cx<span class="token operator">:</span> xLoc<span class="token punctuation">,</span>
      cy<span class="token operator">:</span> yLoc<span class="token punctuation">,</span>
      cz<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
      min<span class="token operator">:</span> <span class="token number">15</span><span class="token punctuation">,</span>
      max<span class="token operator">:</span> <span class="token number">25</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> i<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">dist</span><span class="token punctuation">(</span>locationsCircle<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> point<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> locationsCircle<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> point<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> limit<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">continue</span> outer<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    locationsCircle<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>point<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// now we add spheres that orbit the box (as a circle)</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> numOfLoc<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> ballGeometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>SphereGeometry</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshPhongMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    color<span class="token operator">:</span> <span class="token number">0xffffff</span><span class="token punctuation">,</span>
    emissive<span class="token operator">:</span> <span class="token number">0x444444</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> ball <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>ballGeometry<span class="token punctuation">,</span> material<span class="token punctuation">)</span><span class="token punctuation">;</span>
  ball<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">=</span> locationsCircle<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  ball<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y <span class="token operator">=</span> locationsCircle<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  ball<span class="token punctuation">.</span>position<span class="token punctuation">.</span>z <span class="token operator">=</span> locationsCircle<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>ball<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>For placing the objects in a semicircle (so that they don&#39;t end up inside a wall), we modify the start and end angle in the <code>neighbour_location_circle</code> function:</p>
<pre><code class="language-javascript"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> numOfLoc<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  outer<span class="token operator">:</span> <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> point <span class="token operator">=</span> <span class="token function">neighbour_location_circle</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      cx<span class="token operator">:</span> <span class="token number">45</span><span class="token punctuation">,</span>
      cy<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
      cz<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
      min<span class="token operator">:</span> <span class="token number">15</span><span class="token punctuation">,</span>
      max<span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span>
      startAngle<span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span>
      endAngle<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token number">3</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> i<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">dist</span><span class="token punctuation">(</span>locationsCircle<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> point<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> locationsCircle<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> point<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> limit<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">continue</span> outer<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    locationsHalfCircle<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>point<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="adding-new-data-points">Adding New Data Points</h2>
<p>It was also time to make the room visuals a bit more advanced. One of the elements of the room is a big blob that floats in the middle – a bit like a brain inside a head. Luckily, when working on my own art project on my free time, I had bumped into this <a href="https://www.clicktorelease.com/blog/experiments-with-perlin-noise/">resource</a> about deformations with Perlin noise.</p>
<p>This animated blob is based on a vertex shader and fragment shader, added with a texture image. It&#39;s a good example on how to use normals and materials in deformations. An interesting thing with textures is that they can add a whole other dimension to the visual: you can use any image as a texture, and the shape will then reflect that image, hinting at a space or object that exists outside the viewport.</p>
<p>Finally, I spent time on the Python side of the app, adding a bunch of new variables that are based on the NLP calculations. The values that client side receives are now:</p>
<ul>
<li><code>avgTone</code></li>
<li><code>avgSubj</code></li>
<li><code>numOfMe</code> (number of &quot;I&quot; and &quot;me&quot; words)</li>
<li><code>avgSentenceLength</code></li>
<li><code>numOfUnique</code> (number of unique words)</li>
<li><code>interactionAmount</code> (number of @ tags)</li>
<li><code>numOfNeg</code> (number of negative tweets)</li>
<li><code>numOfPos</code></li>
<li><code>numOfNeutr</code></li>
<li><code>numOfAll</code></li>
</ul>
<p>I always enjoy exploring how easily Python can handle data. For example, I was prepared for requiring multiple lines of code to extract all the @ tags from an account. Finally it was just:</p>
<pre><code class="language-python">interactions <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r'@[\w\.-]+'</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>whole_text_sample<span class="token punctuation">)</span><span class="token punctuation">)</span>
numOfInteractions <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>interactions<span class="token punctuation">)</span>
</code></pre>
<hr>
</div><footer class="post-footer"><img class="post-footer-image" src="../../images/team/veera.png" alt width="120" height="120" /><p>By <a href="../../team/veera.html">Veera Jussila</a></p><p>07/06/2021</p></footer></article></main></body></html>